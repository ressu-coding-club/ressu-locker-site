<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets API with API Key</title>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
    <h1>Google Sheets Data</h1>
    <pre id="content"></pre>

    <script>
        // Parts of this code were generated by ChatGPT.

        const API_KEY = 'API-KEY';  // Replace with your API key
        const spreadsheetId = 'SPREADSHEET-ID';  // Replace with your spreadsheet ID
        /* spreadsheet ID can be found from the URL of the Google Sheets page. For example, 
        in https://docs.google.com/spreadsheets/d/1exnQoSxlGyMNUQmXQJ6O26uVQwwO04/edit,
        1exnQoSxlGyMNUQmXQJ6O26uVQwwO04 is the spreadsheet ID. */
        const range = 'Sheet1!A1:B10';  // Adjust this to the range of data you want

        // Initializes the Google API Client
        function initGapiClient() {
            gapi.client.init({
                apiKey: API_KEY,
                discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'], // this does not need to change
            }).then(() => {
                getSheetData();
            }).catch((error) => {
                console.error('Error during GAPI client initialization:', error);
            });
        }

        // Get data from the sheet
        function getSheetData() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: spreadsheetId,
                range: range,
            }).then((response) => {
                const data = response.result.values;
                if (data && data.length) {
                    let output = '';
                    data.forEach(row => {
                        output += row.join(', ') + '\n';
                    });
                    document.getElementById('content').textContent = output;
                } else {
                    document.getElementById('content').textContent = 'No data found.';
                }
            }).catch((error) => {
                console.error('Error fetching sheet data:', error);
            });
        }

        // Load the GAPI client library and initialize it
        function loadGapiClient() {
            gapi.load('client', initGapiClient);
        }

        // Start the process
        loadGapiClient();
    </script>
</body>
</html>
